<style>
    .tags-box .active {        
        color: black;
    }
</style>

<div class="filter-box">    
    <a href="javascript:void(0);" class="filter-btn">{{filter}}</a>
    <button class="tags-close" id = "resetCategories"></button>    
    <div class="tags-box">
        {{#each categories}}
        <a href="javascript:void(0);" class="single-tag project-category-item" data-filter=".data-filter-{{id}}" categoryId = "{{id}}">{{title}}</a> 
        {{/each}}
    </div>
</div>

<div class="projects">

</div>

<div class="clearfix page-bottom"></div>
<!--div class="btn-wrap">
    <a class="show-more" id="portfolioShowMore" href="javascript:void(0);">{{show_more}}</a>
</div-->

<script type="text/javascript">
    $(".filter-btn").click(function (e) {
        e.preventDefault();

        $(this).animate(function () {
            opacity: 1
        }, 200, function () {
            $(".filter-box").animate({
                height: $(".tags-box").outerHeight() + 15
            }, 200);
            $(".filter-btn").hide();
            $(".tags-close").fadeIn();
            $(".tags-box").addClass("opened-tags");
        });
    });

    $(".tags-close").click(function (e) {
        e.preventDefault();

        $(".tags-box").removeClass("opened-tags");
        $(this).fadeOut();
        setTimeout(function () {
            $(".filter-btn").fadeIn();
            $(".filter-box").animate({
                height: 145
            }, 200);
        }, 400);

    });

    $(window).on('page.view.portfolio.portfolio.renderWidgetItems', function () {
        app.logger.text('$grid = $(".projects").isotope');
        $('.filter-box .tags-box').off('click');

        // init Isotope
        var $grid = $('.projects').isotope({
            itemSelector: '.project-box',
            layoutMode: 'fitRows'
        });

        // filter functions
        var filterFns = {
            // show if number is greater than 50
            numberGreaterThan50: function () {
                var number = $(this).find('.number').text();
                return parseInt(number, 10) > 50;
            },
            // show if name ends with -ium
            ium: function () {
                var name = $(this).find('.name').text();
                return name.match(/ium$/);
            }
        };

        var cid = sessionStorage.getItem('projects.index.filter.category_id');

        if (cid) {
            var filterValue = '.data-filter-' + cid;
            // use filterFn if matches value
            filterValue = filterFns[ filterValue ] || filterValue;

            $grid.isotope({filter: filterValue});
        }

        // bind filter a click
        $('.filter-box .tags-box').on('click', 'a', function () {
            var filterValue = $(this).attr('data-filter');
            app.logger.text('.filter-box .tags-box a click() filterValue:' + filterValue);
            // use filterFn if matches value
            filterValue = filterFns[ filterValue ] || filterValue;
            $grid.isotope({filter: filterValue});
        });

        // bind filter a click
        $('#resetCategories').click(function () {
            $grid.isotope({filter: "*"});
            $('.filter-box .tags-box a').removeClass("active");
            sessionStorage.removeItem('projects.index.filter.category_id');
        });

        // change is-checked class on a
        $('.filter-box .tags-box a').click(function () {
            $('.filter-box .tags-box a').removeClass("active");
            $(this).addClass('active');
        });

    });




</script>